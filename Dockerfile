FROM dockersamples/visualizer

LABEL maintainer="Secret Lee" \
      io.daocloud.dce.plugin.name="dce-visualizer-plugin" \
      io.daocloud.dce.plugin.description="visualizer 是 Docker Swarm Mode 的可视化工具" \
      io.daocloud.dce.plugin.categories="container-tool" \
      io.daocloud.dce.plugin.icon-src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0iIzliYTNhZiI+CiAgPHRpdGxlPmRvY2tlcjwvdGl0bGU+CiAgPGc+CiAgICA8cGF0aCBkPSJNMzEuMzkyLDE0LjU2NWE1LjA0Nyw1LjA0NywwLDAsMC0zLjczNS0uMzM4LDQuOTY1LDQuOTY1LDAsMCwwLTIuMDE5LTMuMTYzbC0wLjQtLjMxNS0wLjMzOS4zOGE0LjE4NCw0LjE4NCwwLDAsMC0uNzksMy4wMSwzLjg2MSwzLjg2MSwwLDAsMCwuNzU0LDIuMDIyLDUuODY0LDUuODY0LDAsMCwxLTEuMDg2LjQ3OEE3LjI2Myw3LjI2MywwLDAsMSwyMS41MzgsMTdIMC40MjRsLTAuMDQ1LjQ3M2E4LjgzMyw4LjgzMywwLDAsMCwuNzQzLDQuNmwwLjI4OSwwLjU3M0wxLjQ0NCwyMi43YzEuOTg1LDMuMjc4LDUuOTQ1LDQuOTc2LDkuNzQ0LDQuOTc2LDcuMzU2LDAsMTIuOTQ5LTMuNTExLDE1LjczNi0xMC4yNTcsMS44NjIsMC4wOTUsMy43NjctLjQ0MSw0LjY3OC0yLjE2OWwwLjIzMi0uNDQxLTAuNDQyLS4yNDhoMFpNNi41NzcsMjMuMWExLjY1MSwxLjY1MSwwLDEsMSwxLjctMS42NTEsMS42NzcsMS42NzcsMCwwLDEtMS43LDEuNjUxaDBaIi8+CiAgICA8cGF0aCBkPSJNNi41NzcsMjAuNTc2YTAuODY5LDAuODY5LDAsMSwwLC44OTQuODcsMC44ODIsMC44ODIsMCwwLDAtLjg5NC0wLjg3Ii8+CiAgICA8cmVjdCB4PSIyIiB5PSIxMyIgd2lkdGg9IjMiIGhlaWdodD0iMyIvPgogICAgPHJlY3QgeD0iNiIgeT0iMTMiIHdpZHRoPSIzIiBoZWlnaHQ9IjMiLz4KICAgIDxyZWN0IHg9IjYiIHk9IjkiIHdpZHRoPSIzIiBoZWlnaHQ9IjMiLz4KICAgIDxyZWN0IHg9IjEwIiB5PSI5IiB3aWR0aD0iMyIgaGVpZ2h0PSIzIi8+CiAgICA8cmVjdCB4PSIxMCIgeT0iMTMiIHdpZHRoPSIzIiBoZWlnaHQ9IjMiLz4KICAgIDxyZWN0IHg9IjE0IiB5PSIxMyIgd2lkdGg9IjMiIGhlaWdodD0iMyIvPgogICAgPHJlY3QgeD0iMTgiIHk9IjEzIiB3aWR0aD0iMyIgaGVpZ2h0PSIzIi8+CiAgICA8cmVjdCB4PSIxNCIgeT0iOSIgd2lkdGg9IjMiIGhlaWdodD0iMyIvPgogICAgPHJlY3QgeD0iMTQiIHk9IjUiIHdpZHRoPSIzIiBoZWlnaHQ9IjMiLz4KICA8L2c+Cjwvc3ZnPgo=" \
      io.daocloud.dce.plugin.vendor="Community" \
      io.daocloud.dce.plugin.required-dce-version=">=2.2.0" \
      io.daocloud.dce.plugin.nano-cpus-limit="500000000" \
      io.daocloud.dce.plugin.memory-bytes-limit="52428800"

RUN sed -i s/8080/80/g /app/server.js

COPY ./plugin.json /app/dist/plugin.json

RUN sed -i s/window.location.host/window.location.host+window.location.pathname/g /app/dist/app.js

EXPOSE 80
